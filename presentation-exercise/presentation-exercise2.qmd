---
title: "Tidy Tuesday Exercise"
author: "Emma Hardin-Parker"
date: "04/14/2024"
---

# Library Packages

```{r}
library(tidymodels)
library(tidyverse)
library(ggplot2)
library(plotly)
```


# Introduction & Data Import 

```{r}
getwd()
fight_songs <- read_csv("/Users/emmahardinparker/Desktop/BIOS8060E/emmahardinparker-MADA-portfolio/presentation-exercise/fight-songs.csv")

str(fight_songs)
```
```{r}
# Remove rows with missing or unknown values in sec_duration and bpm columns
fight_clean <- fight_songs %>%
  drop_na(sec_duration, bpm)

print(colnames(fight_clean))


# Clean the data and calculate average bpm for each school
# Replace 'bpm' with the actual column name if it's different
avg_bpm_by_school <- fight_clean %>%
  group_by(school) %>%
  summarise(avg_bpm = mean(bpm)) %>%
  ungroup()

print(colnames(avg_bpm_by_school))


```

```{r}
# Create ggplot scatter plot with average lines
ggplot(fight_clean, aes(x = sec_duration, y = bpm, color = school)) +
  geom_point(alpha = 0.5) +
  geom_hline(data = avg_bpm_by_school, aes(yintercept = avg_bpm),
             linetype = 'dashed', color = 'red', alpha = 0.5) +
  labs(x = 'Duration (seconds)', y = 'Beats per minute',
       title = 'Duration vs BPM with Average Lines') +
  xlim(0, 180) +
  ylim(0, 200) +
  theme_minimal() +
  theme(legend.position = 'right') +
  guides(color = guide_legend(title = 'School'))

# Create interactive plotly plot from ggplot object
plot_ly(fight_clean, x = ~sec_duration, y = ~bpm, color = ~school, 
        text = ~paste('School:', school, '<br>BPM:', bpm),
        hoverinfo = 'text') %>%
  add_markers(alpha = 0.5) %>%
  add_segments(data = avg_bpm_by_school, x = ~0, xend = ~180, y = ~avg_bpm, yend = ~avg_bpm,
               line = list(dash = 'dash', color = 'red', width = 1, alpha = 0.5)) %>%
  layout(title = 'Interactive Duration vs BPM with Average Lines',
         xaxis = list(title = 'Duration (seconds)', range = c(0, 180)),
         yaxis = list(title = 'Beats per minute', range = c(0, 200)),
         legend = list(title = 'School'))
```

